<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GstPad Overview &mdash; gstreamer_tutorial 1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=e536ea0c" />
      <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=29a6c3e3"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script>let toggleHintShow = 'Click to show';</script>
        <script>let toggleHintHide = 'Click to hide';</script>
        <script>let toggleOpenOnPrint = 'true';</script>
        <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
        <script src="../_static/design-tabs.js?v=36754332"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="gst bin" href="gst-bin.html" />
    <link rel="prev" title="gst element overview" href="gst-element.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            gstreamer_tutorial
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">1. GStreamer 基础</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">GStreamer 概论</a></li>
<li class="toctree-l2"><a class="reference internal" href="design.html">GStreamer 设计原则</a></li>
<li class="toctree-l2"><a class="reference internal" href="preliminary.html">GStreamer 预备知识</a></li>
<li class="toctree-l2"><a class="reference internal" href="basic.html">GStreamer 基础知识</a></li>
<li class="toctree-l2"><a class="reference internal" href="concept.html">GStreamer 基本概念</a></li>
<li class="toctree-l2"><a class="reference internal" href="nv12.html">NV12 format</a></li>
<li class="toctree-l2"><a class="reference internal" href="glib.html">glib Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="gobject.html">gobject overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="gst-element.html">gst element overview</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">GstPad Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pad">连接 pad</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#request-pad">request pad</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#gstelementfactory">gstelementfactory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gstpad">GstPad</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gst-pad-add-probe">gst_pad_add_probe</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#parameters">Parameters:</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#gstpadtemplate">GstPadTemplate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#gststaticpadtemplate">GstStaticPadTemplate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gst-bin.html">gst bin</a></li>
<li class="toctree-l2"><a class="reference internal" href="gst-bus.html">GstBus overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="gst-buffer.html">GstBuffer</a></li>
<li class="toctree-l2"><a class="reference internal" href="gst-promise.html">GstPromise</a></li>
<li class="toctree-l2"><a class="reference internal" href="gst-caps.html">GStreamer Capabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="gst-state.html">GStreamer State</a></li>
<li class="toctree-l2"><a class="reference internal" href="gst-event.html">GstEvent</a></li>
<li class="toctree-l2"><a class="reference internal" href="gst-query.html">Gstreamer Query</a></li>
<li class="toctree-l2"><a class="reference internal" href="sink-element.html">Sink elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="transform-element.html">Transform elements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../2.tutorial/index.html">2. GStreamer 教程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3.application/index.html">3. GStreamer 应用</a></li>
<li class="toctree-l1"><a class="reference internal" href="../4.plugin/index.html">4. GStreamer 插件</a></li>
<li class="toctree-l1"><a class="reference internal" href="../5.tool/index.html">6. GStreamer Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../6.misc/index.html">5. DeepStream</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">gstreamer_tutorial</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">1. GStreamer 基础</a></li>
      <li class="breadcrumb-item active">GstPad Overview</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/1.basic/gst-pad.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gstpad-overview">
<h1>GstPad Overview<a class="headerlink" href="#gstpad-overview" title="Link to this heading"></a></h1>
<p>Pad 是元件之间的连接器， 它有两个方向 GstPadDirection</p>
<ul class="simple">
<li><p>source pads 产生数据</p></li>
<li><p>sink pads 消费数据</p></li>
</ul>
<p>Pad 有三种有效性</p>
<ul class="simple">
<li><p>always: pad 在元件中永远存在</p></li>
<li><p>sometimes: pad 只在特定的条件下存在</p></li>
<li><p>on request: pad 只在应用程序要求时才创建(存在)</p></li>
</ul>
<section id="pad">
<h2>连接 pad<a class="headerlink" href="#pad" title="Link to this heading"></a></h2>
<section id="request-pad">
<h3>request pad<a class="headerlink" href="#request-pad" title="Link to this heading"></a></h3>
<p>An element can also have request pads. These pads are not created automatically but are only created on demand.</p>
<p>This is very useful for multiplexers, aggregators and tee elements. Aggregators are elements that merge the content of several input streams together into one output stream.</p>
<p>Tee elements are the reverse: they are elements that have one input stream and copy this stream to each of their output pads, which are created on request.</p>
<p>Whenever an application needs another copy of the stream, it can simply request a new output pad from the tee element.</p>
<p>The following piece of code shows how you can request a new output pad from a “tee” element:</p>
<p>元件 还可以具有 request pad. 这些 pad 不会自动创建，而是仅根据需要创建。</p>
<p>这对于多路复用器 multiplexers、聚合器 aggregators 和 Tee 元件非常有用。</p>
<p>聚合器是将多个输入流的内容合并到一个输出流中的元素。</p>
<p>Tee 元素则相反 – 它是具有一个输入流的元素，并将该流复制到每个输出 pad（根据请求创建）。</p>
<p>每当应用程序需要流的另一个副本时，它可以简单地从 tee 元素请求新的 request pad。</p>
<p>下面的代码展示了如何从 <code class="docutils literal notranslate"><span class="pre">tee</span></code> 元件 请求新的 sink pad：</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="nf">some_function</span><span class="w"> </span><span class="p">(</span><span class="n">GstElement</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">tee</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">GstPad</span><span class="w"> </span><span class="o">*</span><span class="n">pad</span><span class="p">;</span>
<span class="w">  </span><span class="n">gchar</span><span class="w"> </span><span class="o">*</span><span class="n">name</span><span class="p">;</span>

<span class="w">  </span><span class="n">pad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gst_element_request_pad_simple</span><span class="w"> </span><span class="p">(</span><span class="n">tee</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;src%d&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gst_pad_get_name</span><span class="w"> </span><span class="p">(</span><span class="n">pad</span><span class="p">);</span>
<span class="w">  </span><span class="n">g_print</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;A new pad %s was created</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span>
<span class="w">  </span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">);</span>

<span class="w">  </span><span class="cm">/* here, you would link the pad */</span>

<span class="w">  </span><span class="cm">/* [..] */</span>

<span class="w">  </span><span class="cm">/* and, after doing that, free our reference */</span>
<span class="w">  </span><span class="n">gst_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">GST_OBJECT</span><span class="w"> </span><span class="p">(</span><span class="n">pad</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">gst_element_request_pad_simple()</span></code> 方法可用于根据 pad 模板的名称从元素获取 pad。</p>
<p>还可以请求与其他 pad template 兼容的 pad。 如果您想要将一个元件链接到多路复用器元素并且需要请求兼容的 pad，那么这个方法非常有用。</p>
<p>方法 <code class="docutils literal notranslate"><span class="pre">gst_element_get_known_pad()</span></code> 可用于请求兼容的 pad ，如下一个示例所示。 它将从任何输入请求来自 Ogg 多路复用器的兼容 pad。</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>
<span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="nf">link_to_multiplexer</span><span class="w"> </span><span class="p">(</span><span class="n">GstPad</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">tolink_pad</span><span class="p">,</span><span class="w"> </span><span class="n">GstElement</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mux</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">GstPad</span><span class="w"> </span><span class="o">*</span><span class="n">pad</span><span class="p">;</span>
<span class="w">  </span><span class="n">gchar</span><span class="w"> </span><span class="o">*</span><span class="n">srcname</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">sinkname</span><span class="p">;</span>

<span class="w">  </span><span class="n">srcname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gst_pad_get_name</span><span class="w"> </span><span class="p">(</span><span class="n">tolink_pad</span><span class="p">);</span>
<span class="w">  </span><span class="n">pad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gst_element_get_compatible_pad</span><span class="w"> </span><span class="p">(</span><span class="n">mux</span><span class="p">,</span><span class="w"> </span><span class="n">tolink_pad</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="w">  </span><span class="n">gst_pad_link</span><span class="w"> </span><span class="p">(</span><span class="n">tolink_pad</span><span class="p">,</span><span class="w"> </span><span class="n">pad</span><span class="p">);</span>
<span class="w">  </span><span class="n">sinkname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gst_pad_get_name</span><span class="w"> </span><span class="p">(</span><span class="n">pad</span><span class="p">);</span>
<span class="w">  </span><span class="n">gst_object_unref</span><span class="w"> </span><span class="p">(</span><span class="n">GST_OBJECT</span><span class="w"> </span><span class="p">(</span><span class="n">pad</span><span class="p">));</span>

<span class="w">  </span><span class="n">g_print</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;A new pad %s was created and linked to %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sinkname</span><span class="p">,</span><span class="w"> </span><span class="n">srcname</span><span class="p">);</span>
<span class="w">  </span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">sinkname</span><span class="p">);</span>
<span class="w">  </span><span class="n">g_free</span><span class="w"> </span><span class="p">(</span><span class="n">srcname</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>注意 <code class="docutils literal notranslate"><span class="pre">gst_element_request_pad_simple</span></code> 只能以 GStreamer 1.20 及其以上版本才可使用，低版本的还是要使用 <code class="docutils literal notranslate"><span class="pre">gst_element_request_pad</span></code></p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>
<span class="n">GstPad</span><span class="w"> </span><span class="o">*</span>
<span class="n">gst_element_request_pad</span><span class="w"> </span><span class="p">(</span><span class="n">GstElement</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">element</span><span class="p">,</span>
<span class="w">                         </span><span class="n">GstPadTemplate</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">templ</span><span class="p">,</span>
<span class="w">                         </span><span class="k">const</span><span class="w"> </span><span class="n">gchar</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">name</span><span class="p">,</span>
<span class="w">                         </span><span class="k">const</span><span class="w"> </span><span class="n">GstCaps</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">caps</span><span class="p">)</span>

</pre></div>
</div>
<p>Retrieves a request pad from the element according to the provided template.
Pad templates can be looked up using <code class="docutils literal notranslate"><span class="pre">gst_element_factory_get_static_pad_templates</span></code>.</p>
<p>The pad should be released with gst_element_release_request_pad.</p>
<p>Parameters:</p>
<ul class="simple">
<li><p>element – a GstElement to find a request pad of.</p></li>
<li><p>templ – a GstPadTemplate of which we want a pad of.</p></li>
<li><p>name ( [transfer: none][allow-none]) – the name of the request GstPad to retrieve. Can be NULL.</p></li>
<li><p>caps ( [transfer: none][allow-none]) – the caps of the pad we want to request. Can be NULL.</p></li>
</ul>
<p>Returns ( [transfer: full][nullable]) – requested GstPad if found, otherwise NULL. Release after usage.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span>
<span class="w">   </span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;gst/gst.h&gt;</span>

<span class="w">   </span><span class="n">GstElement</span><span class="w"> </span><span class="o">*</span><span class="n">src</span><span class="p">;</span>
<span class="w">   </span><span class="n">GstElementFactory</span><span class="w"> </span><span class="o">*</span><span class="n">srcfactory</span><span class="p">;</span>

<span class="w">   </span><span class="n">gst_init</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;</span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">argv</span><span class="p">);</span>

<span class="w">   </span><span class="n">srcfactory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gst_element_factory_find</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;filesrc&quot;</span><span class="p">);</span>
<span class="w">   </span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">srcfactory</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="w">   </span><span class="n">src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gst_element_factory_create</span><span class="w"> </span><span class="p">(</span><span class="n">srcfactory</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;src&quot;</span><span class="p">);</span>
<span class="w">   </span><span class="n">g_return_if_fail</span><span class="w"> </span><span class="p">(</span><span class="n">src</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span>
<span class="w">   </span><span class="p">...</span>

</pre></div>
</div>
</section>
</section>
<section id="gstelementfactory">
<h2>gstelementfactory<a class="headerlink" href="#gstelementfactory" title="Link to this heading"></a></h2>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">gst_element_factory_get_static_pad_templates</span><span class="w"> </span>
<span class="k">const</span><span class="w"> </span><span class="n">GList</span><span class="w"> </span><span class="o">*</span>
<span class="n">gst_element_factory_get_static_pad_templates</span><span class="w"> </span><span class="p">(</span><span class="n">GstElementFactory</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">factory</span><span class="p">)</span>
<span class="n">Gets</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">GList</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">GstStaticPadTemplate</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">factory</span><span class="p">.</span>

<span class="c1">//Parameters: factory – a GstElementFactory</span>
<span class="w">  </span>
<span class="c1">//Returns ( [transfer: none][element-typeGst.StaticPadTemplate]) – the static pad templates</span>
</pre></div>
</div>
</section>
<section id="gstpad">
<h2>GstPad<a class="headerlink" href="#gstpad" title="Link to this heading"></a></h2>
<p>A GstElement is linked to other elements via “pads”, which are extremely light-weight generic link points.</p>
<blockquote>
<div><p>GstPad 是 GstElement 之间的连接点</p>
</div></blockquote>
<p>Pads have a GstPadDirection, source pads produce data, sink pads consume data.</p>
<blockquote>
<div><p>GstPad 是有方向的 GstPadDirection, source pads 产生数据， sink pads 消费数据</p>
</div></blockquote>
<p>Pads are typically created from a GstPadTemplate with gst_pad_new_from_template and are then added to a GstElement. This usually happens when the element is created but it can also happen dynamically based on the data that the element is processing or based on the pads that the application requests.</p>
<blockquote>
<div><p>gst_pad_new_from_template 用来从 GstPadTemplate 创建 Pad, 它可以动态创建</p>
</div></blockquote>
<p>Pads without pad templates can be created with gst_pad_new, which takes a direction and a name as an argument. If the name is NULL, then a guaranteed unique name will be assigned to it.</p>
<p>A GstElement creating a pad will typically use the various gst_pad_set_*_function() calls to register callbacks for events, queries or dataflow on the pads.</p>
<p>gst_pad_get_parent will retrieve the GstElement that owns the pad.</p>
<p>After two pads are retrieved from an element by gst_element_get_static_pad, the pads can be linked with gst_pad_link. (For quick links, you can also use gst_element_link, which will make the obvious link for you if it’s straightforward.). Pads can be unlinked again with gst_pad_unlink. gst_pad_get_peer can be used to check what the pad is linked to.</p>
<p>Before dataflow is possible on the pads, they need to be activated with gst_pad_set_active.</p>
<p>gst_pad_query and gst_pad_peer_query can be used to query various properties of the pad and the stream.</p>
<p>To send a GstEvent on a pad, use gst_pad_send_event and gst_pad_push_event. Some events will be sticky on the pad, meaning that after they pass on the pad they can be queried later with gst_pad_get_sticky_event and gst_pad_sticky_events_foreach. gst_pad_get_current_caps and gst_pad_has_current_caps are convenience functions to query the current sticky CAPS event on a pad.</p>
<blockquote>
<div><p>gst_pad_send_event 和 gst_pad_push_event 可用来发送 GstEvent</p>
</div></blockquote>
<p>GstElements will use gst_pad_push and gst_pad_pull_range to push out or pull in a buffer.</p>
<blockquote>
<div><p>gst_pad_push and gst_pad_pull_range 也可从推或拉数据</p>
</div></blockquote>
<p>The dataflow, events and queries that happen on a pad can be monitored with probes that can be installed with gst_pad_add_probe. gst_pad_is_blocked can be used to check if a block probe is installed on the pad. gst_pad_is_blocking checks if the blocking probe is currently blocking the pad. gst_pad_remove_probe is used to remove a previously installed probe and unblock blocking probes if any.</p>
<blockquote>
<div><p>在 pad 中经过的数据流，events 以及 queries 可通过 probes 来监测，方法是 gst_pad_add_probe</p>
</div></blockquote>
<p>Pad have an offset that can be retrieved with gst_pad_get_offset. This offset will be applied to the running_time of all data passing over the pad. gst_pad_set_offset can be used to change the offset.</p>
<p>Convenience functions exist to start, pause and stop the task on a pad with gst_pad_start_task, gst_pad_pause_task and gst_pad_stop_task respectively.</p>
</section>
<section id="gst-pad-add-probe">
<h2>gst_pad_add_probe<a class="headerlink" href="#gst-pad-add-probe" title="Link to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gulong</span>
<span class="n">gst_pad_add_probe</span> <span class="p">(</span><span class="n">GstPad</span> <span class="o">*</span> <span class="n">pad</span><span class="p">,</span>
                   <span class="n">GstPadProbeType</span> <span class="n">mask</span><span class="p">,</span>
                   <span class="n">GstPadProbeCallback</span> <span class="n">callback</span><span class="p">,</span>
                   <span class="n">gpointer</span> <span class="n">user_data</span><span class="p">,</span>
                   <span class="n">GDestroyNotify</span> <span class="n">destroy_data</span><span class="p">)</span>
</pre></div>
</div>
<p>Be notified of different states of pads. The provided callback is called for every state that matches mask.</p>
<p>Probes are called in groups: First GST_PAD_PROBE_TYPE_BLOCK probes are called, then others, then finally GST_PAD_PROBE_TYPE_IDLE. The only exception here are GST_PAD_PROBE_TYPE_IDLE probes that are called immediately if the pad is already idle while calling gst_pad_add_probe. In each of the groups, probes are called in the order in which they were added.</p>
<section id="parameters">
<h3>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>pad – the GstPad to add the probe to</p></li>
<li><p>mask – the probe mask</p></li>
<li><p>callback – GstPadProbeCallback that will be called with notifications of the pad state</p></li>
<li><p>user_data ( [closure]) – user data passed to the callback</p></li>
<li><p>destroy_data – GDestroyNotify for user_data</p></li>
</ul>
<p>GstPadProbeType 有如下定义</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">typedef</span> <span class="n">enum</span>
<span class="p">{</span>
  <span class="n">GST_PAD_PROBE_TYPE_INVALID</span>          <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
  <span class="o">/*</span> <span class="n">flags</span> <span class="n">to</span> <span class="n">control</span> <span class="n">blocking</span> <span class="o">*/</span>
  <span class="n">GST_PAD_PROBE_TYPE_IDLE</span>             <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">0</span><span class="p">),</span>
  <span class="n">GST_PAD_PROBE_TYPE_BLOCK</span>            <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">),</span>
  <span class="o">/*</span> <span class="n">flags</span> <span class="n">to</span> <span class="n">select</span> <span class="n">datatypes</span> <span class="o">*/</span>
  <span class="n">GST_PAD_PROBE_TYPE_BUFFER</span>           <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">),</span>
  <span class="n">GST_PAD_PROBE_TYPE_BUFFER_LIST</span>      <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">),</span>
  <span class="n">GST_PAD_PROBE_TYPE_EVENT_DOWNSTREAM</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">),</span>
  <span class="n">GST_PAD_PROBE_TYPE_EVENT_UPSTREAM</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">7</span><span class="p">),</span>
  <span class="n">GST_PAD_PROBE_TYPE_EVENT_FLUSH</span>      <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">),</span>
  <span class="n">GST_PAD_PROBE_TYPE_QUERY_DOWNSTREAM</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">9</span><span class="p">),</span>
  <span class="n">GST_PAD_PROBE_TYPE_QUERY_UPSTREAM</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">10</span><span class="p">),</span>
  <span class="o">/*</span> <span class="n">flags</span> <span class="n">to</span> <span class="n">select</span> <span class="n">scheduling</span> <span class="n">mode</span> <span class="o">*/</span>
  <span class="n">GST_PAD_PROBE_TYPE_PUSH</span>             <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">12</span><span class="p">),</span>
  <span class="n">GST_PAD_PROBE_TYPE_PULL</span>             <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">13</span><span class="p">),</span>

  <span class="o">/*</span> <span class="n">flag</span> <span class="n">combinations</span> <span class="o">*/</span>
  <span class="n">GST_PAD_PROBE_TYPE_BLOCKING</span>         <span class="o">=</span> <span class="n">GST_PAD_PROBE_TYPE_IDLE</span> <span class="o">|</span> <span class="n">GST_PAD_PROBE_TYPE_BLOCK</span><span class="p">,</span>
  <span class="n">GST_PAD_PROBE_TYPE_DATA_DOWNSTREAM</span>  <span class="o">=</span> <span class="n">GST_PAD_PROBE_TYPE_BUFFER</span> <span class="o">|</span> <span class="n">GST_PAD_PROBE_TYPE_BUFFER_LIST</span> <span class="o">|</span> <span class="n">GST_PAD_PROBE_TYPE_EVENT_DOWNSTREAM</span><span class="p">,</span>
  <span class="n">GST_PAD_PROBE_TYPE_DATA_UPSTREAM</span>    <span class="o">=</span> <span class="n">GST_PAD_PROBE_TYPE_EVENT_UPSTREAM</span><span class="p">,</span>
  <span class="n">GST_PAD_PROBE_TYPE_DATA_BOTH</span>        <span class="o">=</span> <span class="n">GST_PAD_PROBE_TYPE_DATA_DOWNSTREAM</span> <span class="o">|</span> <span class="n">GST_PAD_PROBE_TYPE_DATA_UPSTREAM</span><span class="p">,</span>
  <span class="n">GST_PAD_PROBE_TYPE_BLOCK_DOWNSTREAM</span> <span class="o">=</span> <span class="n">GST_PAD_PROBE_TYPE_BLOCK</span> <span class="o">|</span> <span class="n">GST_PAD_PROBE_TYPE_DATA_DOWNSTREAM</span><span class="p">,</span>
  <span class="n">GST_PAD_PROBE_TYPE_BLOCK_UPSTREAM</span>   <span class="o">=</span> <span class="n">GST_PAD_PROBE_TYPE_BLOCK</span> <span class="o">|</span> <span class="n">GST_PAD_PROBE_TYPE_DATA_UPSTREAM</span><span class="p">,</span>
  <span class="n">GST_PAD_PROBE_TYPE_EVENT_BOTH</span>       <span class="o">=</span> <span class="n">GST_PAD_PROBE_TYPE_EVENT_DOWNSTREAM</span> <span class="o">|</span> <span class="n">GST_PAD_PROBE_TYPE_EVENT_UPSTREAM</span><span class="p">,</span>
  <span class="n">GST_PAD_PROBE_TYPE_QUERY_BOTH</span>       <span class="o">=</span> <span class="n">GST_PAD_PROBE_TYPE_QUERY_DOWNSTREAM</span> <span class="o">|</span> <span class="n">GST_PAD_PROBE_TYPE_QUERY_UPSTREAM</span><span class="p">,</span>
  <span class="n">GST_PAD_PROBE_TYPE_ALL_BOTH</span>         <span class="o">=</span> <span class="n">GST_PAD_PROBE_TYPE_DATA_BOTH</span> <span class="o">|</span> <span class="n">GST_PAD_PROBE_TYPE_QUERY_BOTH</span><span class="p">,</span>
  <span class="n">GST_PAD_PROBE_TYPE_SCHEDULING</span>       <span class="o">=</span> <span class="n">GST_PAD_PROBE_TYPE_PUSH</span> <span class="o">|</span> <span class="n">GST_PAD_PROBE_TYPE_PULL</span>
<span class="p">}</span> <span class="n">GstPadProbeType</span><span class="p">;</span>

</pre></div>
</div>
</section>
</section>
<section id="gstpadtemplate">
<h2>GstPadTemplate<a class="headerlink" href="#gstpadtemplate" title="Link to this heading"></a></h2>
<p>Padtemplates describe the possible media types a pad or an elementfactory can handle. This allows for both inspection of handled types before loading the element plugin as well as identifying pads on elements that are not yet created (request or sometimes pads).</p>
<p>Pad and PadTemplates have GstCaps attached to it to describe the media type they are capable of dealing with. gst_pad_template_get_caps or GST_PAD_TEMPLATE_CAPS are used to get the caps of a padtemplate. It’s not possible to modify the caps of a padtemplate after creation.</p>
<p>PadTemplates have a GstPadPresence property which identifies the lifetime of the pad and that can be retrieved with GST_PAD_TEMPLATE_PRESENCE. Also the direction of the pad can be retrieved from the GstPadTemplate with GST_PAD_TEMPLATE_DIRECTION.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">GST_PAD_TEMPLATE_NAME_TEMPLATE()</span></code> is important for GST_PAD_REQUEST pads because it has to be used as the name in the gst_element_request_pad_simple call to instantiate a pad from this template.</p>
<p>Padtemplates can be created with <code class="docutils literal notranslate"><span class="pre">gst_pad_template_new</span></code> or with <code class="docutils literal notranslate"><span class="pre">gst_static_pad_template_get()</span></code>, which creates a GstPadTemplate from a GstStaticPadTemplate that can be filled with the convenient GST_STATIC_PAD_TEMPLATE macro.</p>
<p>A padtemplate can be used to create a pad (see gst_pad_new_from_template or gst_pad_new_from_static_template ()) or to add to an element class (see gst_element_class_add_static_pad_template ()).</p>
<p>The following code example shows the code to create a pad from a padtemplate.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w">   </span><span class="n">GstStaticPadTemplate</span><span class="w"> </span><span class="n">my_template</span><span class="w"> </span><span class="o">=</span>
<span class="w">   </span><span class="n">GST_STATIC_PAD_TEMPLATE</span><span class="w"> </span><span class="p">(</span>
<span class="w">     </span><span class="s">&quot;sink&quot;</span><span class="p">,</span><span class="w">          </span><span class="c1">// the name of the pad</span>
<span class="w">     </span><span class="n">GST_PAD_SINK</span><span class="p">,</span><span class="w">    </span><span class="c1">// the direction of the pad</span>
<span class="w">     </span><span class="n">GST_PAD_ALWAYS</span><span class="p">,</span><span class="w">  </span><span class="c1">// when this pad will be present</span>
<span class="w">     </span><span class="n">GST_STATIC_CAPS</span><span class="w"> </span><span class="p">(</span><span class="w">        </span><span class="c1">// the capabilities of the padtemplate</span>
<span class="w">       </span><span class="s">&quot;audio/x-raw, &quot;</span>
<span class="w">         </span><span class="s">&quot;channels = (int) [ 1, 6 ]&quot;</span>
<span class="w">     </span><span class="p">)</span>
<span class="w">   </span><span class="p">);</span>
<span class="w">   </span><span class="kt">void</span>
<span class="w">   </span><span class="nf">my_method</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">     </span><span class="n">GstPad</span><span class="w"> </span><span class="o">*</span><span class="n">pad</span><span class="p">;</span>
<span class="w">     </span><span class="n">pad</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gst_pad_new_from_static_template</span><span class="w"> </span><span class="p">(</span><span class="o">&amp;</span><span class="n">my_template</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sink&quot;</span><span class="p">);</span>
<span class="w">     </span><span class="p">...</span>
<span class="w">   </span><span class="p">}</span>
</pre></div>
</div>
<p>The following example shows you how to add the padtemplate to an element class, this is usually done in the class_init of the class:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="w">   </span><span class="k">static</span><span class="w"> </span><span class="kt">void</span>
<span class="w">   </span><span class="nf">my_element_class_init</span><span class="w"> </span><span class="p">(</span><span class="n">GstMyElementClass</span><span class="w"> </span><span class="o">*</span><span class="n">klass</span><span class="p">)</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">     </span><span class="n">GstElementClass</span><span class="w"> </span><span class="o">*</span><span class="n">gstelement_class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GST_ELEMENT_CLASS</span><span class="w"> </span><span class="p">(</span><span class="n">klass</span><span class="p">);</span>

<span class="w">     </span><span class="n">gst_element_class_add_static_pad_template</span><span class="w"> </span><span class="p">(</span><span class="n">gstelement_class</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">my_template</span><span class="p">);</span>
<span class="w">   </span><span class="p">}</span>
</pre></div>
</div>
<section id="gststaticpadtemplate">
<h3>GstStaticPadTemplate<a class="headerlink" href="#gststaticpadtemplate" title="Link to this heading"></a></h3>
<p>It is Structure describing the GstStaticPadTemplate.</p>
<p>Members:</p>
<ul class="simple">
<li><p>name_template (const gchar *) – the name of the template</p></li>
<li><p>direction (GstPadDirection) – the direction of the template</p></li>
<li><p>presence (GstPadPresence) – the presence of the template</p></li>
<li><p>static_caps (GstStaticCaps) – the caps of the template.</p></li>
</ul>
</section>
</section>
<section id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>https://gstreamer.freedesktop.org/documentation/application-development/basics/pads.html?gi-language=c</p></li>
<li><p>https://gstreamer.freedesktop.org/documentation/plugin-development/advanced/request.html?gi-language=c</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="gst-element.html" class="btn btn-neutral float-left" title="gst element overview" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="gst-bin.html" class="btn btn-neutral float-right" title="gst bin" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021 ~ 2023, Walter Fan, Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>